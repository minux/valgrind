
Bugs reported after the release of 3.7.0
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This file lists bugs that were reported after 3.7.0 was released, both
in 3.7.0 and trunk, and that have not been closed.  Bugs that have
been closed as "fixed" are listed in the top level NEWS file instead.
In other words they get listed here first and moved to NEWS if they
get fixed.

284004  Application under test hangs after call to __posix_spawn (Darwin)
  open, not started

284540  Memcheck shouldn't count suppressions matching
        still-reachable allocations
  wishlist, w/patch, unclear if important

284904  Avoid cycles by disabling inclusive costs for cycles?
  wishlist

285780  Nice to be able to display (animate) movement of variables through caches
  wishlist

286769  replace __intel_new_memcpy with valgrind's memcpy
  not started

286849  Interceptors for new/delete on Darwin were erroneously commented
        out in r12043
  **potentially 3.8.0

286864  strlen function redirection error
  **probably invalid

286917  disInstr(arm): unhandled instruction: QADD
  **potentially 3.8.0

287175  ARM: scalar VFP fixed-point VCVT instructions not handled
  **potentially 3.8.0

288099  valgrind should print arguments/return values of functions in stack
  wishlist

287862  MPI_IN_PLACE not supported for MPI collect
  libmpiwrap.c problem; low prio

288274  Aborts at illegal instruction 0x48 0xF 0x5A 0x7 0x48 0xF
  == 278744 REX.W CVTPS2PD
  **potentially 3.8.0 (redundant REX prefix)

288298  unhandled syscall shm_unlink
  OSX.  uninvestigated.

288363  valgrind: m_libcfile.c:73 (vgPlain_safe_fd): Assertion
        'newfd >= VG_(fd_hard_limit)' failed.
  OSX weirdness; uninvestigated

288756  add '-x' to strip when stripping dynamic libraries on OSX
  OSX.  low prio

--- JRS got this far, tidying up, 30 June 2012.

289360  parse_type_DIE confused by DW_TAG_enumeration_type
  low prio; --read-var-info=yes problem

289470  Loading of large Mach-O thin binaries fails.
  w/ patch; apparently harmless; easy fix

289578  Backtraces with unwind tables (=without debug symbols)
        using offline symbol resolving
  wishlist

289584  Unhandled instruction: 0xF 0x29 0xE5 (MOVAPS)
  movaps reg,reg (w/ patch)

289699  vgdb connection erroneously closed due to buffer overrun
        when vgdb reads a burst of packets in relay mode
  **3.7.1 FIXED r12319

289836  Unhanded instructions mfatbu and mfatbl
  ppc e500 insns

289839  s390x:Provide support for unicode conversion instruction
        like cu21,cu12,cu42 etc.
  s390

289912  link_tool_exe_darwin should not use relative paths
  unsupported build configuration; low prio

289939  wish: complete monitor cmd 'leak_check' with details
        about leaked or reachable blocks.
  in progress; but not suitable for 3.7.1

290006  memcheck doesn't mark %xmm as initialized after "pcmpeqw %xmm %xmm"
  easy fix; w/ patch

290061  pie elf always loaded at 0x108000
  w/ patch; looks OK; easy fix ?

290066  Warning messages from libraries with Valgrind 3.7.0
  ppc elfery wierdness

290384  Valgrind does not show line numbers
  on 32 bit FC16

293751  Unhandled instruction in Cocoa Apps ( Intel Core i7,  MacOS X 10.7.2 )
  == 290655  Add support for AESKEYGENASSIST instruction
  **3.7.1 FIXED r12384 r2247

290673  wine+valgrind: failed to start tool 'memcheck' for platform
        'x86-linux': No such  file or directory
  probably invalid; build config problem?

290719  valgrind-3.7.0 fails with automake-1.11.2 due to"pkglibdir" usage
  seems like low prio

290974  vgdb must align pages to VKI_SHMLBA (16KB) on ARM
  **3.7.1 FIXED r12366

(Sun 8 Jan 2012)

291253  ES register not initialised in valgrind simulation
  FIXED, r12394.

291310  FXSAVE instruction marks memory as undefined on amd64
  x86 vs amd64 inconsistency?

291568  Fix 3DNOW-related crashes with baseline x86_64 CPU (w patch)
  FIXED, r2259

291865  s390x: Support Compare Double and Swap
  in progress

291924  vex x86->IR: unhandled instruction bytes: 0x66 0xF 0x38 0x31
  invalid (SSE4)

292281  Not supported LL cache size of AMD Opteron 6176
  hmm, more cache size kludgery required

292430  3.8.0svn build encounters unrecognized instruction in
        __intel_get_new_mem_ops_cpuid
  FIXED, r2255

292626  Missing fcntl F_SETOWN_EX and F_GETOWN_EX support
  FIXED, r12373

292627  Missing support for some SCSI ioctls
  FIXED, r12375

292628  none/tests/x86/bug125959-x86.c triggers undefined behavior
  FIXED, r12358

292958  ARM SVC instructions with non-zero immediates are not supported.
  invalid

292993  implement the getcpu syscall on amd64-linux
  FIXED, r12371

292995  Implement the “cross memory attach” syscalls introduced in Linux 3.2
  FIXED, r12374

278313  Fedora 15/x64: err read debug info with --read-var-info=yes flag
  seems complex; is reopened

293088  Add some VEX sanity checks for ppc64 unhandled instructions
  FIXED, r2249, r12387

289823  vex amd64->IR: 0x66 0xF 0x3A 0x60 0xCA 0x45 0x66 0xF
  == 293754  PCMPxSTRx not implemented for 16-bit characters
  FIXED, r2254, r12389.

293755  No tests for PCMPxSTRx on 16-bit characters
  subsumed by 293754

--- 10 Feb 2012

293808  CLFLUSH not supported by latest VEX for amd64
  FIXED, r2252

293855  vex amd64->IR: 0x2F 0x55 0x73 0x65 0x72 0x73 0x2F 0x6A
  some problem with interceptors on Helgrind/OSX 

294047  valgrind does not correctly emulate prlimit64(..., RLIMIT_NOFILE, ...)
  FIXED r12411.

294048  MPSADBW instruction not implemented
  FIXED r2260, r12395.

294055  valgrind regtest none/tests/shell fails when locale is not set to C
  FIXED r12386

294065  valgrind running wine does not find pdb file because of wrong path to egrep
  w/ somewhat dodgy patch

294147  Exception in thread "main" java
  probably invalid

294185  INT 0x44 (and others) not supported on x86 guest, but used by Jikes RVM
  FIXED r2251

294190  --vgdb-error=xxx can be out of sync with errors shown by valgrind
        to the user
  FIXED r12388

294191  Guest amd64 lacks fnsave/frstor and 0x66 size prefixes on FP instructions
  FIXED r2253

-- 16 Feb 2012

294254] New: False "invalid read" errors for aligned SSE loads
294260] New: vex: the 'impossible' happened:  disInstr_AMD64: disInstr miscalculated next %rip
294285] New: --partial-loads-ok does not work for 16-byte SSE loads
294454] New: delphi uses 16-bit addressing in the TEB (%fs)
294523] New: --partial-loads-ok=yes causes false negatives
294552] New: svn trunk compilation stuck in mig
294617] New: vex amd64->IR: unhandled instruction bytes: 0x66 0xF 0x3A 0xDF 0xD1 0x1 0xE8 0x6A
294736] New: Valgrind crashes with Unrecognised instruction 0x48 0xF 0xD7 0xD6 0x48 0x83
294812] New: patch allowing to run (on x86 at least) helgrind/drd on tool.
294861] New: ./configure fails to locate Boost (located in /usr/local)
 295053] New: Valgrind fails to load some x86_64 Mac OS Lion executables
295077] New: Client app registered are showed incorrectly when doing "info reg" from attached GDB
295084] New: Hard-coded /usr/include
295089] New: can not annotate source for both helgrind and drd
251569] rdtscp not supported: vex amd64->IR: unhandled instruction bytes: 0xF 0x1 0xF9 0x8B 0x4C 0x24
295221] New: POWER Processor decimal floating point instruction support missing
295403] New: Memory access below SP with some STRD instructions.
295414] New: link to bugzilla is broken from web page
295427] New: building i386 support with clang on darwin11 requires -new_linker linker option
295428] New: coregrind/m_main.c has incorrect x86 assembly for darwin
295472] New: "executable has wrong endian-ness" when target executable has correct endianess
295514] New: unhandled instruction bytes : 0x66 0x9C (pushfw on x86_64)
295528] New: callgrind_control -z --zero not working
295590] New: Helgrind: hg_main.c:2298 (evh__HG_PTHREAD_COND_WAIT_POST): Assertion 'cvi->nWaiters > 0' failed.
295617] New: ARM - Add some missing syscalls
295799] New: Missing \n with get_vbits in gdbserver when line is % 80 and there are some unaddressable bytes
295808] New: vex amd64->IR: unhandled instruction bytes: 0xF3 0xF 0xBC 0xC0 0x48 0x1 0xD0 0x48

-- 11 March 2012

Please consider applying the patch contained in bz #274078.  It should make these sorts of questions go away (or at least make them substantially rarer).
https://bugs.kde.org/show_bug.cgi?id=274078

295974] New: vex-x86 omits some SSE4.1 opcodes such as PEXTRD
296030] New: The valgrind cann't work with sun hotspot jvm, the jvm
cann't startup.
296166] New: Add support for ARM in ptrcheck
296229] New: Linux user input device ioctls missing wrappers
296308] New: helgrind tests fail on Linux/x86 due to clone syscall
missing unwind info
296311] New: Wrong stack traces due to -fomit-frame-pointer (x86)

296318] New: Debug info improvements (more than one rx/rw mapping)
296422] New: Add translation chaining support
296457] New: vex amd64->IR: unhandled instruction bytes: 0x66 0xF 0x3A
0xDF 0xD1 0x1 0xE8 0x6A
296472] New: valgrind reports 32-bit uninitialized reads as "Uninitialised value of size 8" on x86_64
296480] New: valgrind hangs early when run on Python
296577] New: vex x86->IR: unhandled instruction bytes: 0x66 0xF 0x3A 0x17
296578] New: vex amd64->IR: unhandled instruction bytes: 0x60 0x0 0x0 0x0 0x0 0x0 0x0 0x0
296792] New: [PATCH] valgrind 3.7.0: add SIOCSHWTSTAMP (0x89B0) ioctl wrapper
296947] New: vex amd64->IR: unhandled instruction bytes: 0x1F 0x7 0x0 0x0 0x0 0x0
296983] New: build issues on x86_64
297078] New: gdbserver signal handling problems caused by diff vki nr/gdb nr and non reset of "C-ontinued" signal
297147] New: drd false positives on newly allocated memory
297329] New: VEX should disallow decoding of IBM Power Decimal Floating Point instructions on machines that do not support it
297407] New: Failed reading debug information for Fortran codes; invalid cuOff
297497] New: POWER Processor decimal floating point instruction support missing
297701] New: Another alias for strncasecmp_l in libc-2.13.so
297911] New: valgrind does not report 'invalid write' when using APIs for custom memory allocators.
297976] New: s390x: revisit EX implementation
297991] New: Valgrind interferes with mmap()+ftell()
297992] New: Support pre-2.6.10 Linux systems (i.e. lack of WIFCONTINUED)
297993] New: Generation of libvex_guest_offsets.h fails with -g3
298080] New: POWER Processor decimal floating point instruction support missing, part 3
 298097] New: on ppc32 (e500mc core) target, valgrind report a app a mem error but the app is good to me.
298227] New: valgrind unhandled instruction (vex amd64->IR: unhandled instruction bytes: 0xC5 0xF8 0x57 0xC0 0x48 0xC7 0x43 0x58)
298281] New: wcslen causes false(?) uninitialised value warnings
298335] New: Valgrind crashes after "vex amd64->IR: unhandled instruction bytes: 0xC5 0xF9 0x57 0xC0 0x48 0x8B 0x35 0x3"
298354] New: Unhandled ARM Thumb instruction 0xEB0D 0x0585 (streq)
298394] New: s390x: valgrind is not future proof
298421] New: accept4() syscall (366) support is missing for ARM
298546] New: wishlist: track virtual memory leaks due to mmap without munmap
298718] New: vex amd64->IR: unhandled instruction bytes: 0xF 0xB1 0xCB 0x9C 0x8F 0x45
298732] New: valgrind installation problem in ubuntu with kernel version 3.x
298862] New: POWER Processor decimal floating point instruction support missing, part 4
298864] New: DWARF reader mis-parses DW_FORM_ref_addr
298870] New: No support for DW_TAG_partial_unit
298905] New: argv / argc to be changed to non valgrind values.
298943] New: massif asserts with --pages-as-heap=yes when brk is chaning by value different of page size
299053] New: [patch] Support DWARF4 DW_AT_high_pc constant form

-- Sun 29 Apr 2012, near midnight.

299104] New: vex amd64->IR: unhandled instruction bytes: 0xC5 0xF8 0x57 0xC0 0x48 0x89 0xE5 0x41
299316] New: Helgrind: hg_main.c:628 (map_threads_lookup): Assertion 'thr' failed.
299629] New: dup3() syscall (358) support is missing for ARM
299694] New: POWER Processor decimal floating point instruction support missing, part 5
299756] New: asymmetric --malloc-fill/--free-fill behavior with mempools
299803] New: vex amd64->IR: unhandled instruction bytes: 0xC5 0xF1 0x57 0xC9 0xC5 0xF9 0x2E 0xC8
99804] New: vex amd64->IR: unhandled instruction bytes: 0xC5 0xFB 0x2A 0xC2 0xC5 0xFB 0x59 0x5
299805] New: vex amd64->IR: unhandled instruction bytes: 0xC5 0xFA 0x10 0x5 0x6D 0xDD 0x0 0x0
00102] New: memcheck tester
300128] New: valgrind exits traced program writing to non-existent popen()
300140] New: ARM - Missing (T2) SMMUL
300195] New: read_elf_debug_info() should accept 'executable' .got sections
300389] New: AMD Bulldozer system: vex: priv/main_main.c:315 (LibVEX_Translate): Assertion `are_valid_hwcaps(VexArchAMD64, vta->archinfo_host.hwcaps)' failed.
300414] New: FCOM and FCOMP unimplemented for amd64 guest

294260] vex: the 'impossible' happened:  disInstr_AMD64: disInstr miscalculated next %rip  -- IS FIXED?

270777 -- the mips port, is fixed
301011] New: vex x86->IR: unhandled instruction bytes: 0xF3 0xF 0xBC 0xDE
301204] New: infinite loop in canonicaliseSymtab with ifunc symbol
301229] New: posix_memalign fails for 2MB alignment
301265] New: add x86 support to Android build
301269] New: optimize Memcheck to use light tracking for trusted code
301280] New: vex amd64->IR: unhandled instruction bytes: 0xF 0xB 0x55 0x48 0x89 0xE5 0x41 0x56
301281] New: valgrind hangs on OS X when the process calls system()
301336] New: Valgrind vassert(0) in dis_neon_data_2reg_misc()
301830] New: mtV : improve Valgrind so that it runs multiple threads in parallel
301902] New: vex amd64->IR: unhandled instruction bytes: 0xF 0xB 0xF 0x1F 0x0 0x40 0x38 0xFE
301922] New: gcc -O2 problem with SSE optimization?
301967] New: unhandled instruction bytes 0xC5 0xF9 0x6E 0x40 in /lib32/ld-2.14.1.so
301984] New: configure script doesn't detect certain versions of clang
302205] New: Fix compiler warnings for POWER VEX code and POWER test cases
302234] New: fesetround() function does not affect FPU calculations
302271] New: Bug with Callgrind dump-instr and Trace-children
302287] New: Unhandled movbe instruction on Atom processors
302271] Bug with Callgrind dump-instr and Trace-children
302370] New: The nmadd, fnmsub, fnmadds, fnmsubs instructions always negate the result even when the result is QNAN or SNAN.
302536] New: Fix for the POWER Valgrind regression test: memcheck-ISA2.0.
302578] New: Unrecognized isntruction 0xc5 0x32 0xc2 0xca 0x09 vcmpngess
302630] New: Memcheck on ultithreaded program fails with Assertion 'sizeof(UWord) == sizeof(UInt)' failed in m_syscall.c
302656] New: Unhandled instruction (vcvtsi2ssq)
302700] New: Assertion 'srcix >= 0 && srcix < VG_(sizeXA)(srcxa)' failed.
302709] New: valgrind for ARM needs extra tls support for android emulator under Linux
302800] New: valgrind change the operator new's alloctor into system's

-- Sat 30 June 2012, near midnight.
